#! Test SCF and DF-MP2 on post-Ar atoms

molecule {
Ba
Ba 1 4.0
}

set {
  basis def2-svp
  points 5
}

ref_energy =  -50.11011922912507 #TEST

analytic_grad, wfn = gradient('scf', return_wfn=True)
this_energy = wfn.energy()
findif_grad = gradient('scf', dertype=0)
assert compare_values(findif_grad, analytic_grad, 6, "Analytic vs. FinDiff Gradient (SCF)") #TEST
assert compare_values(ref_energy, this_energy, 6, "Calculated vs. Reference Energy (SCF)") #TEST
clean()


molecule {
In
In 1 4.0
}

set {
  basis def2-svp
  points 5
}

ref_energy = -378.4048482415655 #TEST

analytic_grad, wfn = gradient('scf', return_wfn=True)
this_energy = wfn.energy()
findif_grad = gradient('scf', dertype=0)
assert compare_values(findif_grad, analytic_grad, 6, "Analytic vs. FinDiff Gradient (SCF)") #TEST
assert compare_values(ref_energy, this_energy, 6, "Calculated vs. Reference Energy (SCF)") #TEST
clean()

molecule {
Sr
Sr 1 4.0
}

set {
  basis def2-svp
  mp2_type df
}

ref_energy =-60.8332750388071943  #TEST

this_energy = energy('mp2')
assert compare_values(ref_energy, this_energy, 6, "Calculated vs. Reference Energy (DF-MP2)") #TEST
clean()
